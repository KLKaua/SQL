CREATE DATABASE DB_MARKETING;
USE DB_MARKETING;

CREATE TABLE VENDEDORES (
  COD_VENDEDOR INT PRIMARY KEY,
  NOME VARCHAR (60) NOT NULL,
  ID_ESCRITORIO INT,
  DATA_ADMISSAO DATE,
  META DECIMAL (12,2),
  VENDAS DECIMAL (12,2),
  COD_GERENTE INT NULL
);

INSERT INTO VENDEDORES (COD_VENDEDOR, NOME, ID_ESCRITORIO, DATA_ADMISSAO, META, VENDAS, COD_GERENTE) VALUES
(101, 'Ana Souza',	11, '2004-05-10', 500000.00, 520000.00, 104),
(102, 'Bruno Lima',	13, '2007-03-22', 450000.00, 390000.00, 104),
(103, 'Carla Mendes',	22, '2005-11-02', 600000.00, 730000.00, 108),
(104, 'Bob Silva',	11, '2000-01-15', 800000.00, 900000.00, NULL),
(105, 'Daniela Ribeiro',	13, '2006-09-09', 300000.00, 250000.00, 104),
(106, 'Eduardo Santos',	22, '2008-12-19', 550000.00, 570000.00, 108),
(107, 'Fernando Carvalho',	11, '2010-04-30', 400000.00, 380000.00, 104),
(108, 'Gustavo Almeida',	22, '2001-07-01', 900000.00, 910000.00, NULL),
(109, 'Helena Martins',	13, '2009-08-18', 320000.00, 345000.00, 104),
(110, 'Igor Pires',	22, '2012-02-27', 610000.00, 590000.00, 108),
(111, 'Joana Queiroz',   11, '2013-06-05', 480000.00, 510000.00, 104),
(112, 'Luis Fernando',   13, '2014-01-14', 350000.00,  3650000.00, 104);

SELECT * FROM VENDEDORES;

SELECT NOME, ID_ESCRITORIO, DATA_ADMISSAO FROM VENDEDORES;

SELECT NOME, META, VENDAS FROM VENDEDORES WHERE COD_VENDEDOR = 107;

SELECT NOME, DATA_ADMISSAO FROM VENDEDORES WHERE VENDAS > 500000;

SELECT NOME, META, VENDAS, COD_GERENTE FROM VENDEDORES;

-- usando NOT BETWEEN conforme pedido
SELECT * FROM VENDEDORES
WHERE VENDAS NOT BETWEEN (0.8 * META) AND (1.2 * META);

SELECT * FROM VENDEDORES WHERE ID_ESCRITORIO IN (11, 13, 22);

SELECT * FROM VENDEDORES WHERE NOME LIKE 'A%';

SELECT * FROM VENDEDORES
WHERE DATA_ADMISSAO BETWEEN '2007-01-01' AND '2010-12-31';

SELECT DISTINCT ID_ESCRITORIO FROM VENDEDORES;

SELECT * FROM VENDEDORES WHERE COD_GERENTE IS NULL;

SELECT * FROM VENDEDORES WHERE COD_GERENTE IS NOT NULL;

SELECT COD_VENDEDOR, NOME, (VENDAS - META) AS DIFERENCA
FROM VENDEDORES
ORDER BY DIFERENCA DESC;

SELECT SUM(VENDAS) AS TOTAL_VENDAS FROM VENDEDORES;

SELECT AVG(VENDAS) AS MEDIA_VENDAS FROM VENDEDORES;

SELECT MAX(VENDAS) AS MAIOR_VENDA, MIN(VENDAS) AS MENOR_VENDA FROM VENDEDORES;

SELECT ID_ESCRITORIO, COUNT(*) AS QTD_VENDEDORES
FROM VENDEDORES
GROUP BY ID_ESCRITORIO;

SELECT ID_ESCRITORIO, AVG(META) AS MEDIA_META, AVG(VENDAS) AS MEDIA_VENDAS
FROM VENDEDORES
GROUP BY ID_ESCRITORIO;

SELECT COD_VENDEDOR, NOME, VENDAS
FROM VENDEDORES
ORDER BY VENDAS DESC
LIMIT 3;

SELECT ID_ESCRITORIO, SUM(VENDAS) AS TOTAL_VENDAS
FROM VENDEDORES
GROUP BY ID_ESCRITORIO
HAVING SUM(VENDAS) > 1200000;

SELECT *
FROM VENDEDORES
WHERE ID_ESCRITORIO = 11
  AND VENDAS <= META
ORDER BY NOME ASC;
