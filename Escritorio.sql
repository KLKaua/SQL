CREATE DATABASE DB_VENDAS;
USE DB_VENDAS;

CREATE TABLE ESCRITORIOS(
ESCRITORIO_ID INTEGER NOT NULL,
CIDADE VARCHAR (30)  NOT  NULL,
REGIAO VARCHAR (20) NOT  NULL,
GERENTE INTEGER,
 META DECIMAL (9,2),
VENDAS DECIMAL (9,2) NOT NULL,
PRIMARY KEY (ESCRITORIO_ID) );

INSERT INTO ESCRITORIOS
(ESCRITORIO_ID, CIDADE, REGIAO, GERENTE, META, VENDAS) VALUES
(1, 'São Paulo',    'Sudeste',    101, 800000.00, 750000.00),
(2, 'Rio de Janeiro','Sudeste',   102, 600000.00, 620000.00),
(3, 'Belo Horizonte','Sudeste',   103, 500000.00, 480000.00),
(4, 'Curitiba',      'Sul',       104, 450000.00, 470000.00),
(5, 'Porto Alegre',  'Sul',       105, 550000.00, 510000.00),
(6, 'Brasília',      'Centro-Oeste',106, 400000.00, 390000.00),
(7, 'Salvador',      'Nordeste',  107, 350000.00, 365000.00),
(8, 'Recife',        'Nordeste',  108, 300000.00, 280000.00),
(9, 'Fortaleza',     'Nordeste',  109, 320000.00, 330000.00),
(10,'Manaus',        'Norte',     110, 250000.00, 240000.00);

SELECT CIDADE, META, VENDAS
FROM ESCRITORIOS
WHERE REGIAO = 'Sudeste';

SELECT CIDADE
FROM ESCRITORIOS
WHERE ESCRITORIO_ID = 5;

SELECT *
FROM ESCRITORIOS;

SELECT CIDADE, REGIAO
FROM ESCRITORIOS;

SELECT *
FROM ESCRITORIOS
WHERE META > 500000;

SELECT *
FROM ESCRITORIOS
WHERE REGIAO = 'Sudeste';

SELECT *
FROM ESCRITORIOS
WHERE VENDAS > META;

SELECT *
FROM ESCRITORIOS
ORDER BY VENDAS DESC
LIMIT 1;

SELECT CIDADE, META
FROM ESCRITORIOS
ORDER BY META ASC;

SELECT SUM(VENDAS) AS TOTAL_VENDAS
FROM ESCRITORIOS;

SELECT REGIAO, COUNT(*) AS QTD_ESCRITORIOS
FROM ESCRITORIOS
GROUP BY REGIAO;

SELECT REGIAO, AVG(VENDAS) AS MEDIA_VENDAS
FROM ESCRITORIOS
GROUP BY REGIAO;

SELECT CIDADE
FROM ESCRITORIOS
WHERE CIDADE LIKE 'S%';

SELECT *
FROM ESCRITORIOS
WHERE META BETWEEN 300000 AND 600000;

SELECT *
FROM ESCRITORIOS
WHERE GERENTE IS NULL;

SELECT CIDADE, (VENDAS - META) AS DIFERENCA
FROM ESCRITORIOS
ORDER BY DIFERENCA DESC;

SELECT CIDADE, META, VENDAS
FROM ESCRITORIOS
WHERE REGIAO = 'Sudeste' AND VENDAS <= META
ORDER BY CIDADE ASC;

SELECT REGIAO, AVG(META) AS MEDIA_META, AVG(VENDAS) AS MEDIA_VENDAS
FROM ESCRITORIOS
GROUP BY REGIAO;

SELECT *
FROM ESCRITORIOS
ORDER BY VENDAS DESC
LIMIT 3;
